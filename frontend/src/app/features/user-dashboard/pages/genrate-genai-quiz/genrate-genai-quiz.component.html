<div class="container mx-auto px-4 py-6">
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    
    <div class="col-span-1 bg-white p-6 rounded-lg shadow-sm">
      <form (ngSubmit)="generatequiz()" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700">Difficulty</label>
          <select [(ngModel)]="quizobj.Difficulty" name="difficulty" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm">
            <option value="">Select Difficulty</option>
            <option value="Easy">Easy</option>
            <option value="Medium">Medium</option>
            <option value="Hard">Hard</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Category</label>
          <select [(ngModel)]="quizobj.Category" name="category" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm">
            <option value="">Select Category</option>
            <option value="General Knowledge">General Knowledge</option>
            <option value="Science">Science</option>
            <option value="Technology">Technology</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Quiz Type</label>
          <select [(ngModel)]="quizobj.Type" name="type" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm">
            <option value="">Select Type</option>
            <option value="Multiple Choice">Multiple Choice</option>
            <option value="True/False">True/False</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Number of Questions</label>
          <input 
            type="number" 
            [(ngModel)]="quizobj.Nofqustation" 
            name="nofquestions" 
            min="1" 
            max="10" 
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
          >
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Quiz Topic/Text</label>
          <textarea 
            [(ngModel)]="quizobj.text" 
            name="quiztext" 
            rows="4" 
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
            placeholder="Enter text to generate quiz"
          ></textarea>
        </div>

        <button 
          type="submit" 
          [disabled]="loading"
          class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors"
        >
          {{ loading ? 'Generating...' : 'Generate Quiz' }}
        </button>
      </form>
    </div>

    
    <div class="col-span-2 p-4 space-y-6">
      <ng-container *ngIf="quizResult">
        <!-- Quiz Display (Initial state after generation) -->
        <ng-container *ngIf="!quizStarted && !quizCompleted">
          <div class="bg-white p-6 rounded-lg shadow-sm">
            <h2 class="text-xl font-semibold text-gray-800">{{ quizResult.title }}</h2>
            <p class="text-gray-600 mb-4">{{ quizResult.description }}</p>
            <p class="text-sm text-gray-500 mb-6">
              <strong>Category:</strong> {{ quizResult.category }} |
              <strong>Difficulty:</strong> {{ quizResult.difficulty }}
            </p>
            <button (click)="playQuiz()" class="w-full bg-blue-600 text-white py-2 px-4 rounded-button hover:bg-blue-700 transition-colors flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
              </svg>
              Start Quiz
            </button>
          </div>
        </ng-container>

        <!-- Active Quiz (Playing state) -->
        <ng-container *ngIf="quizStarted">
          <div class="bg-white rounded-lg shadow-sm">
            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 h-2">
              <div class="bg-blue-600 h-2" [style.width]="(currentQuestionIndex / quizResult.questions.length * 100) + '%'"></div>
            </div>
            
            <div class="p-6">
              <!-- Question -->
              <div class="mb-8">
                <p class="text-sm font-medium text-gray-500 mb-2">Question {{ currentQuestionIndex + 1 }} of {{ quizResult.questions.length }}</p>
                <p class="text-xl font-medium text-gray-900">{{ quizResult.questions[currentQuestionIndex].question }}</p>
              </div>
              
              <!-- Options -->
              <div class="space-y-4 mb-8">
                <label *ngFor="let option of quizResult.questions[currentQuestionIndex].options; let i = index" 
                      class="block w-full p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors"
                      [class.bg-blue-50]="selectedAnswer === getOptionLetter(i)" 
                      [class.border-blue-300]="selectedAnswer === getOptionLetter(i)">
                  <div class="flex items-center">
                    <input
                      type="radio"
                      [name]="'question-' + currentQuestionIndex"
                      [value]="getOptionLetter(i)"
                      [checked]="selectedAnswer === getOptionLetter(i)"
                      (change)="selectAnswer(getOptionLetter(i))"
                      class="h-5 w-5 text-blue-600 focus:ring-blue-500"
                    />
                    <span class="ml-3 text-gray-800 text-lg">{{ getOptionLetter(i) }}. {{ option }}</span>
                  </div>
                </label>
              </div>
              
              <!-- Navigation -->
              <div class="flex justify-end pt-4">
                <button 
                  (click)="submitAnswer()" 
                  [disabled]="!selectedAnswer"
                  class="bg-blue-600 text-white py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:text-gray-700 disabled:cursor-not-allowed"
                >
                  {{ currentQuestionIndex + 1 === quizResult.questions.length ? 'Finish Quiz' : 'Next Question' }}
                </button>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- Quiz Completed (Results state) -->
        <ng-container *ngIf="quizCompleted">
          <div class="bg-white rounded-lg shadow-sm p-8 text-center">
            <h3 class="text-2xl font-bold text-gray-900 mb-2">Quiz Complete!</h3>
            <p class="text-gray-600 mb-6">You've finished the quiz. Here's how you did:</p>
            
            <div class="mb-8">
              <p class="text-4xl font-bold text-blue-600">{{ score }} / {{ quizResult.questions.length }}</p>
              <p class="text-gray-600">{{ (score / quizResult.questions.length) * 100 | number:'1.0-0' }}% score</p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button 
                (click)="backToQuizGeneration()" 
                class="bg-blue-600 text-white py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors"
              >
                Back to Quiz
              </button>
            </div>
          </div>
        </ng-container>
      </ng-container>

    </div>
  </div>
</div>
